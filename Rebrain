Networks by Rebrain: Траблшутинг сетевых сервисов. Инструменты и утилиты для диагностики

# netstat  Проверка состояния   
- без параметров выведет список всех соединений и состояний в которых находятся эти соединения 
(смотрим состояние state  ESTABLISHE)

netstat  -nt  
-n отображать доменные именя и порты в виде цифр 
-t  только tsp  соединение 

# Есть возможность ограничить выделение рессссурсов сервера используя контрольные группы (cgroups)
##########################################################################
Возможно, имелись в виду контрольные группы (cgroups) в Linux.  12

Cgroups — это механизм ядра Linux, который позволяет ограничивать, учитывать и изолировать использование системных ресурсов для групп процессов. С его помощью можно контролировать, например, процессорное время, количество памяти, доступ к устройствам.  31

Некоторые возможности механизма cgroups:

Ограничение ресурсов. Например, можно ограничить использование памяти, в том числе виртуальной. 2
Приоритизация. Разным группам можно выделить разное количество процессорного ресурса и пропускной способности подсистемы ввода-вывода. 2
Учёт. Подсчёт затрат тех или иных ресурсов группой. 2
Изоляция. Разделение пространств имён для групп таким образом, что одной группе недоступны процессы, сетевые соединения и файлы другой. 2
Управление. Можно приостановить группы, создать контрольные точки и перезагрузить их. 2
Некоторые контроллеры cgroups:

CPU. Контролирует использование процессорного времени. Можно установить лимиты на процент использования CPU или распределять время между группами процессов. 3
Memory. Ограничивает использование оперативной памяти и swap. 3
IO. Контролирует ввод-вывод на блочные устройства. 3
Devices. Управляет доступом к устройствам. Позволяет разрешить или запретить определённым процессам доступ к конкретным устройствам. 3
PIDs. Ограничивает количество процессов в группе. 3
Существует две версии cgroups: v1 и v2. Вторая версия объединяет все контроллеры в единую иерархию и упрощает управление. В современных дистрибутивах Linux по дефолту используется cgroups v2. 3
##########################################################################
# В случае если df -h  показывает 100%   заполненость диска, а  du -sh  в разы меньше - Значит какой-то процесс не отпускает файл, который удалили.
# Надо смотреть через lsof и грохать этот процесс 

lsof — команда в Linux, которая отображает все открытые файлы или идентифицирует процессы, открытые конкретными файлами. 1

Чтобы вывести на экран список всех используемых файлов в операционной системе, нужно выполнить команду lsof без каких-либо опций и аргументов: lsof. 2

Некоторые другие примеры использования команды lsof:

Отображение файлов, используемых конкретным пользователем. Для этого нужно выполнить команду lsof с опцией -u и именем пользователя в качестве аргумента. Например: lsof -u user. 2
Поиск процессов, которые прослушивают сетевые порты. Для этой задачи нужно использовать команду вместе с опцией -i: lsof -i. 2
Вывод файлов, открытых процессами определённого пользователя, которые используют сетевые соединения. Можно объединить опции -i и -u, чтобы вывести на экран информацию о файлах, открытых процессами конкретного пользователя, использующих сетевые соединения. Например: lsof -i -u user. 2
Вывод списка файлов, используемых определённым процессом. Опция -p команды lsof позволяет вывести на экран информацию о файлах, которые открыты конкретным процессом. Например: lsof -p 1. 2
Команда lsof предустановлена в большинстве дистрибутивов Linux. Если её нет в системе, можно установить с помощью менеджера пакетов. 3
##########################################################################

